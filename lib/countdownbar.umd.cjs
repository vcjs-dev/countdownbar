(function(e,n){typeof exports=="object"&&typeof module!="undefined"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(e=typeof globalThis!="undefined"?globalThis:e||self,n(e.Countdownbar={}))})(this,function(e){"use strict";var C=Object.defineProperty;var w=(e,n,s)=>n in e?C(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var o=(e,n,s)=>(w(e,typeof n!="symbol"?n+"":n,s),s);const n=typeof window!="undefined";function s(i){return n?requestAnimationFrame(i):-1}function p(i){n&&cancelAnimationFrame(i)}const u=1e3,f=60*u,m=60*f,d=24*m;function g(i){const t=Math.floor(i/d),r=Math.floor(i%d/m),a=Math.floor(i%m/f),c=Math.floor(i%f/u),h=Math.floor(i%u);return{total:i,days:t,hours:r,minutes:a,seconds:c,milliseconds:h}}function T(i,t){return Math.floor(i/1e3)===Math.floor(t/1e3)}class l{constructor(t){o(this,"rafId",0);o(this,"endTime",0);o(this,"counting",!1);o(this,"remain",0);o(this,"options",{time:0,autoStart:!0});this.options=Object.assign(this.options,t),this.remain=this.options.time,this.options.autoStart&&this.start()}get current(){return g(this.remain)}getCurrentRemain(){return Math.max(this.endTime-Date.now(),0)}setRemain(t){var r,a,c,h;this.remain=t,(a=(r=this.options).onChange)==null||a.call(r,this.current),t===0&&(this.pause(),(h=(c=this.options).onFinish)==null||h.call(c)),this.render()}microTick(){this.rafId=s(()=>{this.counting&&(this.setRemain(this.getCurrentRemain()),this.remain>0&&this.microTick())})}macroTick(){this.rafId=s(()=>{if(this.counting){const t=this.getCurrentRemain();(!T(t,this.remain)||t===0)&&this.setRemain(t),this.remain>0&&this.macroTick()}})}tick(){n&&(this.options.millisecond?this.microTick():this.macroTick())}start(){this.counting||(this.endTime=Date.now()+this.remain,this.counting=!0,this.tick())}reset(t=this.options.time){this.pause(),this.remain=t}pause(){this.counting=!1,p(this.rafId)}generateHTML(){if(this.options.template)return this.options.template(this.current);let t=`${this.current.days}:${this.current.hours}:${this.current.minutes}:${this.current.seconds}`;return this.options.millisecond&&(t+=`:${this.current.milliseconds}`),`<span style="font-size:14px;color:#323233;">${t}</span>`}getContainer(){return typeof this.options.container=="string"?document.querySelector(this.options.container):this.options.container}render(){const t=this.getContainer();t&&(t.innerHTML=`${this.generateHTML()}`)}}const M=i=>new l(i);e.CountdownBar=l,e.createCountdownBar=M,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
